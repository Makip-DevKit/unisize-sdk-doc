2024/09/30時点でObjective-Cへの対応は動作確認中となっています。

# SDKリファレンス（Objective‐C）

## ドキュメントのバージョン情報
* 24/09/20 一部内容追記。UnisizeBanner Class の Delegate にdidBeidChanged()を追加。
* 24/08/16 UnisizeBanner Class に customStyle 関連の情報を追記。
* 24/06/24 UnisizeBanner Class に CIバナー関連の情報を追加。UnisizeBanner クラスの didUnsupported の内容を一部追記
* 24/05/31 リリースにあたり内容を一部変更
* 24/05/29 init() メソッドの sendErrorLog 追加
* 24/05/21 UnisizeCVTag class 内容一部更新
* 24/05/20 初版

---

## unisizeSDK.xcframeworkのインポート
SDK を使用する .m ファイルの先頭（import 文のある箇所）に、`#import <UnisizeSDK/unisizeSDK.h>`を記述します。<br>

```objectiveC
#import <UnisizeSDK/unisizeSDK.h>
```
  
<hr>
  
## UnisizeBanner クラス

| Class               | 継承                |
| :------------------ | :------------------ |
| UnisizeBanner       | UIView, WKScriptMessageHandler |  
  
unisize バナー表示、unisize アンケート画面表示用 Class。ECアプリケーションの商品詳細画面のストーリーボード、ViewController に、バナー表示用の UIView を配置して、UnisizeBanner の初期化のタイミングで渡すことで、unisize バナーを表示することができます。  
unisize バナーの表示から、unisize アンケート画面の表示、アンケート結果を反映したサイズレコメンド処理までを一括で含んでいます。
  <br>

| メソッド、プロパティ、デリゲート | 説明 | 種類 |
| :------------------ | :------------------ | :------------------ |
| [init](#init-メソッド) | UnisizeBannerのinitメソッド。<br>（コンストラクタ） | メソッド<br>（コンストラクタ） |
| [setupParam](#setupparam-メソッド) | パラメーターを再度設定してバナーの表示を更新します。 | メソッド |
| [reload](#reload-メソッド) | unisize バナーをリロードします。 | メソッド |
| [close()](#close-メソッド) | UnisizeBanner Class の deinit メソッド。deinit の際に呼び出している処理と同一です。 | メソッド |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didFinish:(NSString * _Nonnull)didFinish;](#--voidunisizebannerunisizebanner--_nonnullbanner-didfinishnsstring--_nonnulldidfinish) | UnisizeBanner class の処理完了時に実行されるデリゲート。 | デリゲート |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didFail:(UnisizeError * _Nonnull)didFail;](#--voidunisizebannerunisizebanner--_nonnullbanner-didfailunisizeerror--_nonnulldidfail) | UnisizeBanner の処理失敗時に実行されるデリゲート。 | デリゲート |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didResized:(NSString * _Nonnull)didResized width:(CGFloat)width height:(CGFloat)height viewType:(NSString * _Nonnull)viewType;](#--voidunisizebannerunisizebanner--_nonnullbanner-didresizednsstring--_nonnulldidresized-widthcgfloatwidth-heightcgfloatheight-viewtypensstring--_nonnullviewtype) | UnisizeBanner のバナーのリサイズ時に実行されるデリゲート。<br>（※ バナー単位で実行される） | デリゲート |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didLoaded:(NSString * _Nonnull)didLoaded viewType:(NSString * _Nonnull)viewType;](#--voidunisizebannerunisizebanner--_nonnullbanner-didloadednsstring--_nonnulldidloaded-viewtypensstring--_nonnullviewtype)| UnisizeBanner のバナー読み込み完了時に実行されるデリゲート。<br>（※ バナー単位で実行される） | デリゲート |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didUnsupported:(NSString * _Nonnull)didUnsupported;](#--voidunisizebannerunisizebanner--_nonnullbanner-didunsupportednsstring--_nonnulldidunsupported) | 対象商品が unisize 対象外の場合に実行されるデリゲート。 | デリゲート |
| [- (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didBeidChanged:(NSString * _Nonnull)didBeidChanged recommendedItems:(NSString * _Nonnull)recommendedItems type:(NSString * _Nonnull)type;](#func-unisizebanner_-banner-unisizebanner-didbeidchanged-beid-string-recommendeditems-string-type-string) | 【v1.3追加】unisize の beid など unisize の CV タグに必要なデータの値の更新時に実行されます。 | デリゲート |
  
  
### init メソッド
UnisizeBanner Class の init メソッド（コンストラクタ）
TEXTバナー、EXバナー、CIバナーの表示に対応しています。（1画面に対して最大3つのバナーを表示可能） 
```objectiveC
// ECアプリケーションの商品詳細画面の ViewControllerの - (void)viewDidLoad 内で下記を実行

- (void)viewDidLoad {
    [super viewDidLoad];

    // unisizeBanner の初期化とセットアップ
    self.unisizeBanner = [[UnisizeBanner alloc]
                      initWithTextBannerRect: <バナーの表示エリアとして配置した UIView（TEXTバナー）>
                      exBannerRect: <バナーの表示エリアとして配置した UIView（EXバナー）>
                      ciBannerRect: <バナーの表示エリアとして配置した UIView（CIバナー）>
                      parentView: self
                      cid: <クライアントID>
                      itm: ＜商品ID＞
                      cuid: ＜ECサイト側のユーザーID＞
                      lang: ＜言語＞
                      enableWebViewLog: YES
                      enablePrintLog: YES
                      sendErrorLog: YES
                      delegate: self,
                      customStyle: ＜バナーのカスタムスタイル＞
        ];

    ・・・・
    
}


```  
  
  
| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| initWithTextBannerRect   | (nullable) UIView                | TEXTバナー（バナー1）表示エリアとしてストーリーボードに配置した UIView を渡します。<br>※ TEXTバナーを表示しない場合は設定不要<br>※ unisize バナーロード後に、バナータイプに応じて UIView の高さの変更処理をデリゲートで行えます。<br>※ バナーの表示・非表示、高さ変更によるレイアウト調整を行う場合は、制約を UIView に設定してコントロールしてください。 |
| exBannerRect     | (nullable) UIView             | EXバナー（バナー2）表示エリアとしてストーリーボードに配置したUIViewを渡します。<br>※ EXバナーを表示しない場合は設定不要<br>※ unisize バナーロード後に、バナータイプに応じて UIView の高さの変更処理をデリゲートで行えます。<br>※ バナーの表示・非表示、高さ変更によるレイアウト調整を行う場合は、制約を UIView に設定してコントロールしてください。 |
| ciBannerRect     | (nullable) UIView  | CIバナー（バナー3）表示エリアとしてストーリーボードに配置したUIViewを渡します。<br>※ CIバナーを表示しない場合は設定不要<br>※ unisize バナーロード後に、バナータイプに応じて UIView の高さの変更処理をデリゲートで行えます。<br>※ バナーの表示・非表示、高さ変更によるレイアウト調整を行う場合は、制約を UIView に設定してコントロールしてください。 |
| parentView       | UIViewController       | バナークリック時に unisize アンケート画面の表示処理で必要となります。<br>unsizeBanner class を呼び出した UIViewController クラス（self）を渡します。 |
| cid              | NSString                 | クライアントID |
| itm              | NSString                 | アイテムID（アイテムごとに異なります） |
| cuid             | (nullable) NSString                | クライアントユーザーID<br>（ECアプリケーション（サイト）のユーザーログインID）<br>※ ユーザーがECアプリケーションにログインしている場合に必要となります。 |
| lang | (nullable) NSString | 表示言語<br>※ デフォルトは日本語：ja
| enableWebViewLog | BOOL                   | console.log の内容を Xcode のコンソールに出力する
| enablePrintLog   | BOOL                   | UnisizeBanner Class のデバッグログを Xcode のコンソールに出力する
| sendErrorLog     | BOOL                   | エラー発生時にエラーログをunisizeサーバーへ送信します
| delegate         | (nullable) UnisizeBannerDelegate | デリゲートを使用する場合は、selfを渡してください。
スタムスタイルを適用できます。<br>詳しくは付属のドキュメント「unisizeSDK Readme_iOS」の「バナーのカスタムスタイル適用について」を参照ください。（※）
  
* unisize では、バナーにカスタムスタイルを適用することで、unisize バナーのバージョンアップ時に表示崩れや不具合の原因となる可能性があるなどの点から、バナーのカスタマイズを推奨していません。ブランドイメージや、アプリの UI との兼ね合いで、どうしてもバナーカスタマイズが必要な場合に限定してご利用ください。
  
### setupParam メソッド
パラメーターを設定して、バナーの表示を更新します。  
バナーの表示数はsetupParamでは変更不可。init()のタイミングで設定したtextBannerRect、exBannerRect、ciBannerRectに依存します。  
組み込むアプリケーションの構造上、同一ViewControllerのインスタンス内で、動的に表品を切り替えるような設計のアプリケーションの場合は、表品切り替えのタイミングでsetupParam()メソッドを使ってバナーの商品情報も更新してください。  
  
```objectiveC
[self.unisizeBanner setupParamWithCid:cid itm:itm cuid:cuid lang:lang];
```  
  
  
| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| cid              | (nullable) NSString             | クライアントID |
| itm              | (nullable) NSString             | アイテムID（アイテムごとに異なります） |
| cuid             | (nullable) NSString             | クライアントユーザーID<br>（ECアプリケーション（サイト）のユーザーログインID）<br>※ ユーザーがECアプリケーションにログインしている場合に必要となります。 |
| lang | (nullable) NSString | 表示言語<br>※ デフォルトは日本語：ja

※ 渡したパラメーターのみが更新されます。

### reload メソッド
unisizeバナーをリロードします。  
  
通常SDKを使用する際に、reloadメソッドを使用することは想定していませんが、強制的にバナーを更新する必要がある場合のみ使用してください。  
  
※ パラメーターなし
  
### close() メソッド
unisize バナーの各変数を解放して閉じる処理を行います。  
deinit 時に呼び出している処理と同一になります。
  
通常 SDK を使用する際に、close() メソッドを使用することは想定していませんが、強制的に UnisizeBanner Class を解放する必要がある場合のみ使用してください。  
  
※ パラメーターなし
  
### デリゲート の実装
UnisizeBanner class の完了時、バナーリサイズ時、エラー発生時などに、ECアプリケーション側で追加で処理を行う場合は、実装を行います。  
バナーサイズ確定、バナー表示時にUIを調整したり、エラー発生時にユーザーに対して通知するといった場合に有用です。  
  
ECアプリケーションの商品詳細画面の ViewController で unsizeBanner class を初期化した後に、ViewController class（self）を渡して、下記を実装します。  

```objectiveC
// ECアプリケーションの商品詳細画面の ViewController に下記を実装

// コンポーネントの処理完了時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didFinish:(NSString *)message {
         // ここに処理を記載
}

// コンポーネントの処理失敗時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didFail:(UnisizeError *)errorObj {
         // ここに処理を記載
}

// コンポーネントのリサイズ時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didResized:(NSString *)message width:(CGFloat)width height:(CGFloat)height viewType:(NSString *)viewType {
         // ここに処理を記載
}

// WebView のバナー表示時に毎回通知（バナーのリロードが発生した場合も実行される）
- (void)unisizeBanner:(UnisizeBanner *)banner didLoaded:(NSString *)message viewType:(NSString *)viewType {
         // ここに処理を記載
}

// unisize 対象外商品の場合に呼び出される
- (void)unisizeBanner:(UnisizeBanner *)banner didUnsupported:(NSString *)message {
         // ここに処理を記載
}
```

#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didFinish:(NSString * _Nonnull)didFinish;

UnisizeBanner クラスの処理完了時に実行されるデリゲート。  
  
unisize バナーの表示処理完了後にECアプリケーション側で処理を実行したい場合は、ここに実装します。（UI調整など）  
※ UnisizeBanner の処理が全て完了したタイミングで実行されます。  

| パラメーター          | 型                  | 説明
| :------------------ | :------------------ | :------------------
| banner              | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。
| message             | NSString              | ※未使用(空)

```objectiveC
// コンポーネントの処理完了時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didFinish:(NSString *)message {
    // consoleに出力
    NSLog(@"didFinish: message: %@", message);
}
```

#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didFail:(UnisizeError * _Nonnull)didFail;
UnisizeBanner クラスの処理失敗時に実行されるデリゲート。  
  
unisize バナーのエラー発生時にECアプリケーション側で処理を実行したい場合は、ここに実装します。  
（バナー非表示などのUI調整など）  
  
| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| banner              | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。 |
| didFail             | [UnisizeError](#unisizeerror-class)        | UnisizeBannerクラスから返されたUnisizeError classを取得できます。<br>（※UnisizeError classの変数、関数は下記UnisizeError class参照） |
  
```objectiveC
// コンポーネントの処理失敗時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didFail:(UnisizeError *)errorObj {
    // consoleに出力
    NSLog(@"didFail: %@", [errorObj getJsonString]);
        
    // バナーを非表示（バナーのUIViewに制約を設定している場合）
    self.textBannerRectHeightConstraint.constant = 0;
    [self.textBannerRect layoutIfNeeded];
    self.exBannerRectHeightConstraint.constant = 0;
    [self.exBannerRect layoutIfNeeded];
    self.ciBannerRectHeightConstraint.constant = 0;
    [self.ciBannerRect layoutIfNeeded];
}
```
  
#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didResized:(NSString * _Nonnull)didResized width:(CGFloat)width height:(CGFloat)height viewType:(NSString * _Nonnull)viewType;
UnisizeBanner のバナーサイズ確定時に実行されるデリゲート。  
unisize バナーの表示処理完了時にECアプリケーション側で処理を実行したい場合は、ここに実装します。（UI調整など） 
  
| パラメーター           | 型                  | 説明                 |
| :------------------  | :------------------ | :------------------ |
| banner               | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。 |
| didResized (message) | NSString            | 未使用（空） |
| width                | CGFloat             | バナーレンダリング完了時に確定した width を取得できます。<br>（幅はバナータイプによって変動することはありません。そのためこのパラメーターは通常使用することはありません。） |
| height | CGFloat | バナーレンダリング完了時に確定した height を取得できます。<br>（高さはバナータイプによって変動します。） |
| viewType | NSString | どの View のサイズかを確認するための値を取得できます。<br>text_banner：TEXTバナー（バナー1）<br>ex_banner：EXバナー（バナー2） |
  
```objectiveC
// コンポーネントのリサイズ時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didResized:(NSString *)message width:(CGFloat)width height:(CGFloat)height viewType:(NSString *)viewType {
    // consoleに出力
    NSLog(@"didResized: width: %f height: %f type: %@", width, height, viewType);
        
    // バナーを表示するための UIView をサイズ変更
    if ([viewType isEqualToString:@"text_banner"]) {
        self.textBannerRectHeightConstraint.constant = height;
        [self.textBannerRect layoutIfNeeded];
    } else if ([viewType isEqualToString:@"ex_banner"]) {
        self.exBannerRectHeightConstraint.constant = height;
        [self.exBannerRect layoutIfNeeded];
    } else if ([viewType isEqualToString:@"ci_banner"]) {
        self.ciBannerRectHeightConstraint.constant = height;
        [self.ciBannerRect layoutIfNeeded];
    }
}
 ```

#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didLoaded:(NSString * _Nonnull)didLoaded viewType:(NSString * _Nonnull)viewType;
UnisizeBanner のバナー表示完了時に実行されるデリゲート。  
unisize バナーの表示処理完了時にECアプリケーション側で処理を実行したい場合は、ここに実装します。（UI調整など）  
  
※バナー単位で実行されます。（message の値でバナーの判定可能）  

| パラメーター           | 型                  | 説明                 |
| :------------------  | :------------------ | :------------------ |
| banner               | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。 |
| didLoaded (message)  | NSString            | バナーの種類が返されます。 |
| viewType             | NSString            | どの View の表示が完了したかを確認するための値を取得できます。<br>text_banner：TEXTバナー（バナー1）<br>ex_banner：EXバナー（バナー2） |


```objectiveC
// WebView のバナー表示時に毎回通知（バナーのリロードが発生した場合も実行される）
- (void)unisizeBanner:(UnisizeBanner *)banner didLoaded:(NSString *)message viewType:(NSString *)viewType {
    // consoleに出力
    NSLog(@"c: message: %@ type: %@", message, viewType);
}
```

#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didUnsupported:(NSString * _Nonnull)didUnsupported;
対象商品が unisize 対象外の場合に実行されるデリゲート。  
  
対象商品が unisize 対象外の場合にECアプリケーション側で処理を実行したい場合は、ここに実装します。  
（バナー非表示などのUI調整など）  
  
| パラメーター           | 型                  | 説明                 |
| :------------------  | :------------------ | :------------------ |
| banner               | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。 |
| didUnsupported (message)  | NSString         | 対象バナータイプの情報が返されます。（all：全てのバナーで対象外、ci：CIバナーのみ対象外） |

※ v1.1からdidUnsupported (message)の内容をバナータイプを返すように変更しました。これはCIバナーの対応に伴い、TEXT、EXバナーではサポートしているが、CIバナーではサポートしていない商品（キッズ、バッグなど）があるための対応になります。
  
```objectiveC
// unisize 対象外商品の場合に呼び出される
- (void)unisizeBanner:(UnisizeBanner *)banner didUnsupported:(NSString *)message {
    // consoleに対象外のバナータイプを出力
    NSLog(@"didUnsupported: %@", message);
        
        // バナーのUIViewを非表示（バナーのUIViewに制約を設定している場合）
        if ([message isEqualToString:@"all"]) {
            // TEXTバナーを非表示
            self.textBannerRectHeightConstraint.constant = 0;
            [self.textBannerRect layoutIfNeeded];
            
            // EXバナーを非表示
            self.exBannerRectHeightConstraint.constant = 0;
            [self.exBannerRect layoutIfNeeded];
        }
        
        // CIバナーを非表示
        self.ciBannerRectHeightConstraint.constant = 0;
        [self.ciBannerRect layoutIfNeeded];
}
```
  
#### - (void)unisizeBanner:(UnisizeBanner * _Nonnull)banner didBeidChanged:(NSString * _Nonnull)didBeidChanged recommendedItems:(NSString * _Nonnull)recommendedItems type:(NSString * _Nonnull)type; 
【v1.3追加】unisize の beid など unisize の CV タグに必要なデータの値の更新時に実行される Delegate。<br><br>
購入画面 → 購入完了画面が WkWebView で構成されているアプリの場合で、アプリの WkWebView の購入完了画面の HTML に埋め込まれているWeb 版  unisize の CV タグを、アプリでも利用したい場合に使用します。（UnisizeCvTag Classを使わないでコンバージョンを実装する場合。）<br><br>
実装方法など、詳しくは付属のドキュメント「unisizeのコンバージョンの実装について」をご覧ください。 

* unisizeSDK の UnisizeCvTag Class を使用して unisize のコンバージョンを実装する場合は、こちらの実装は不要です。
  
| パラメーター           | 型                  | 説明                 |
| :------------------  | :------------------ | :------------------ |
| banner               | UnisizeBanner       | UnisizeBanner のインスタンスを取得できます。 |
| didBeidChanged (beid)  | String         | unisizeのCVタグに必要なユーザー識別IDを返します。 |
| recommendedItems       | String         | unisizeのCVタグに必要なデータを情報を返します。（JSON形式） |
| type                   | String         | unisizeのバナータイプを返します。 |
  
* beid など unisize の CV タグに必要なデータは、unisize ログイン時、unisize ログアウト時、バナーのサイズのレコメンド時に値が変動します。<br>その都度 Delegate が実行されます。
  
<hr>
  
## UnisizeCVTag class

| Class               | 継承 |
| :------------------ | :------------------ |
UnisizeCVTag          | UIView     WKScriptMessageHandler |
  
unisize のコンバージョン集計に必要な class。ECアプリケーションの購入完了画面の ViewController に実装します。  

| メソッド、プロパティ、デリゲート | 説明 | 種類 |
| :------------------ | :------------------ | :------------------ |
| [init](#init-メソッド-1) | unisize   CVタグを処理する UnisizeCVTag の init メソッドです。（コンストラクタ） | メソッド（コンストラクタ） |
| [close()](#close-メソッド-1) | UnisizeCVTag Class の deinit メソッド。deinit の際に呼び出している処理と同一です。 | メソッド |
| [- (void)unisizeCVTag:(UnisizeCVTag * _Nonnull)banner didFinish:(NSString * _Nonnull)didFinish;](#--voidunisizecvtagunisizecvtag--_nonnullbanner-didfinishnsstring--_nonnulldidfinish) | UnisizeCVTag class の処理完了時に実行されるデリゲート。 | デリゲート |
| [- (void)unisizeCVTag:(UnisizeCVTag * _Nonnull)banner didFail:(UnisizeError * _Nonnull)didFail;](#--voidunisizecvtagunisizecvtag--_nonnullbanner-didfailunisizeerror--_nonnulldidfail) | UnisizeCVTag   class の処理失敗時に実行されるデリゲート。 | デリゲート |

### init メソッド
unisizeCV タグの初期化からUIへコンバージョン集計を処理する UnisizeCVTag class の init メソッド（コンストラクタ）。
ECアプリケーションの購入完了画面の ViewController に実装します。

```objectiveC
// ECアプリケーションの購入完了画面の ViewControllerで、viewDidLoad() のタイミングで下記を実行

// UnisizeCVTagのインスタンス生成
self.unisizeCvTag =[[UnisizeCVTag alloc]
                                initWithCvTagRect: _cvTagRect
                                cid: cid
                                cuid: cuid
                                purchaseid: purchaseid
                                itemnum: itemnumString
                                itemid: itemidString
                                price: priceString
                                size: sizeString
                                iteminfo: iteminfo
                                iteminfojson: iteminfo
                                regType: regType
                                enableWebViewLog: YES
                                enablePrintLog: YES
                                sendErrorLog: YES
                                delegate: self
];
```

| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| initWithCvTagRect           | UIView  | CVタグ表示エリアとして配置した UIView をセットします。<br>※集計用のため実際には何もUI上には表示しません。そのため、画面上の端に最小サイズで配置しても問題ありません。 |
| cid                 | NSString  | クライアントID |
| cuid                | (nullable) NSString | クライアントユーザーID<br>ECサイトのログインID<br>※ユーザーがECアプリケーションにログインしている場合<br>※ログイン前でcuidがない場合は空欄（""）にしてください。 |
| purchaseid          | NSString  | 購入時に発行された注文ID |
| itemnum             | (nullable) NSString | 購入数（アイテム毎）（※下記参照） |
| itemid              | (nullable) NSString | アイテム識別ID（商品ID）（アイテム毎）（※下記参照） |
| price               | (nullable) NSString | 購入したアイテムの金額（アイテム毎）（※下記参照） |
| size                | (nullable) NSString | 購入したアイテムのサイズ（アイテム毎）（※下記参照） |
| iteminfo            | (nullable) NSString | itemnum、itemid、price、size を一つのデータ形式にまとめたデータを渡します。<br>Web版 unisize のCVタグで data-iteminfo を使用している場合は、こちらをご利用ください。<br>使用しない場合は空欄（""）を渡してください。 （※下記参照） |
| iteminfojson        | (nullable) NSString | itemnum、itemid、price、size を json 形式にまとめたデータを渡します。<br>Web版 unisize のCVタグで data-iteminfojson を使用している場合は、こちらをご利用ください。<br>使用しない場合は空欄（""）を渡してください。 （※下記参照） |
| regtype             | (nullable) NSString | ※ 未使用。空欄（""）を渡してください。 |
| enableWebViewLog    | BOOL    | console.log の内容を Xcode のコンソールに出力する |
| enablePrintLog      | BOOL    | SDK のデバッグログを Xcode のコンソールに出力する |
| sendErrorLog        | BOOL                   | エラー発生時にエラーログをunisizeサーバーへ送信します
| delegate            | (nullable) UnisizeCVTagDelegate | デリゲートを使用する場合は、selfを渡してください。 |

* CVタグのパラメーターの渡し方は、各クライアント様ごとに異なります。<br>itemnum、itemid、price、sizeを使用する方法、iteminfo、iteminfojsonで渡す方法があります。<br>基本的にWeb版と同様のパラメーターにデータをセットして受け渡す形で問題ありません。複数商品の場合「#」（%23）区切りに変換して送信します。

※ コンバージョンが正しく送信されているかは、Safariを使った WkWebView デバッグで、「ネットワーク」タブで「tracking」という項目を確認することで、値を確認できます。

#### パラメーター実装例（itemnum、itemid、price、sizeを使用して購入商品を渡す場合）
※ 下記パラメーターは各パラメーターの受け渡し例で、パラメーターはサンプルです。実装する際に、発行されたクライアントID、購入時に発行された注文ID、購入した商品情報の値に置き換えてください。
```objectiveC
NSString *cid = @"AbCdEfGhIjK"; // クライアントID
NSString *cuid = @"AbCdEfGhIjK_log_testuser_001"; // ECサイトの会員ID
NSString *purchaseid = @"AbCdEfGhIjK_123456789"; // 購入時に発行された注文ID
NSArray *itemnum = @[@"2", @"1", @"1", @"1"]; // 購入数（アイテム毎）
NSArray *itemid = @[@"A1234", @"B6789", @"C0987", @"D54321"]; // 購入アイテムのアイテムID
NSArray *price = @[@"4800", @"7500", @"980", @"2980"]; //購入アイテムの金額（アイテム毎）
NSArray *size = @[@"F", @"M", @"M", @"M"]; // 購入したアイテムのサイズ（アイテム毎）
    
// String配列からCVタグが受け取れる形式に変換（「#」区切り）
NSString *itemnumString = [itemnum componentsJoinedByString:@"%23"];
NSString *itemidString = [itemid componentsJoinedByString:@"%23"];
NSString *priceString = [price componentsJoinedByString:@"%23"];
NSString *sizeString = [size componentsJoinedByString:@"%23"];

// UnisizeCVTagのインスタンス生成
self.unisizeCvTag =[[UnisizeCVTag alloc]
                                initWithCvTagRect: _cvTagRect
                                cid: cid
                                cuid: cuid
                                purchaseid: purchaseid
                                itemnum: itemnumString
                                itemid: itemidString
                                price: priceString
                                size: sizeString
                                iteminfo: ""
                                iteminfojson: ""
                                regType: ""
                                enableWebViewLog: YES
                                enablePrintLog: YES
                                sendErrorLog: YES
                                delegate: self
];
```

#### パラメーター実装例（iteminfo を使用して購入商品を渡す場合）
```objectiveC
準備中
```

### デリゲート の実装
デリゲートメソッドを使用する場合は、ECアプリケーションの購入完了画面の ViewController で unsizeCvTag class を初期化した後に、ViewController class（self）を渡して、下記を実装します。  

```objectiveC
ECアプリケーションの購入完了画面の ViewController に下記を実装

// コンポーネントの処理完了時に実行される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didFinish:(NSString *)message {
    // ここに処理を記載
}

// コンポーネントの処理失敗時に実行される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didFail:(UnisizeError *)errorObj {
    // ここに処理を記載
}

// WebView のロード時に通知される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didLoaded:(NSString *)message {
    // ここに処理を記載
}

```
  
### close() メソッド
unisizeCVTag の各変数を解放して閉じる処理を行います。  
deinit 時に呼び出している処理と同一になります。
  
通常 SDK を使用する際に、close() メソッドを使用することは想定していませんが、強制的に UnisizeCVTag Class を解放する必要がある場合のみ使用してください。  
  
※ パラメーターなし
  
#### - (void)unisizeCVTag:(UnisizeCVTag * _Nonnull)banner didFinish:(NSString * _Nonnull)didFinish;
UnisizeCVTag クラスの処理完了時に実行されるデリゲート。  
  
UnisizeCVTag class の表示処理完了後にECアプリケーション側で処理を実行したい場合は、ここに実装します。  
※ UnisizeCVTag class の処理が全て完了したタイミングで実行されます。  
  
| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| cvTag               | UnisizeCVTag        | unisizeCVTag のインスタンスを取得できます。 |
| didFinish（message） | NSString             | ※ 未使用(空) |
  
```objectiveC
// コンポーネントの処理完了時に実行される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didFinish:(NSString *)message {
    // consoleに出力
    NSLog(@"%@", message);
}
```

#### - (void)unisizeCVTag:(UnisizeCVTag * _Nonnull)banner didFail:(UnisizeError * _Nonnull)didFail;
UnisizeCVTag class の処理失敗時に実行されるデリゲート。  
  
UnisizeCVTag class のエラー発生時に、ECアプリケーション側で処理を実行したい場合は、ここに実装します。  
  
| パラメーター          | 型                  | 説明                 |
| :------------------ | :------------------ | :------------------ |
| cvTag | UnisizeCVTag | unisizeCVTagのインスタンスを取得できます。 |
| didFail（errorObj） | UnisizeError | UnisizeCVTag クラスから返されたエラーメッセージを取得できます。 |

```objectiveC
// コンポーネントの処理失敗時に実行される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didFail:(UnisizeError *)errorObj {
    // consoleに出力
    NSLog(@"%@", [errorObj getJsonString]);
}
```
  
<hr>
  
## UnisizeError class

| Class               | 継承                |
| :------------------ | :------------------ |
UnisizeError | なし

UnisizeSDK でエラーが発生した際に、デリゲートで受け取ることができるエラー情報。  
エラー発生時にこの class からエラー関連の情報などを取得することができます。  
  
| メソッド、プロパティ、デリゲート | 説明 | 種類|
| :------------------ | :------------------ | :------------------ |
[getJson](#getjson-メソッド) | エラー情報を配列で返します。 | メソッド
[getJsonString](#getJsonString-メソッド) | エラー情報をJson Stringで返します。 | メソッド

### getJson メソッド

UnisizeSDK のエラー発生時に、エラーに関する全ての情報を JSONObject [NSString: id] 形式で取得できます。
各コンポーネントのデリゲートの didFail で取得可能。  
```objectiveC
// コンポーネントの処理失敗時に実行される
- (void)unisizeBanner:(UnisizeBanner *)banner didFail:(UnisizeError *)errorObj {
    // consoleに出力
    NSLog(@"didFail: %@", [errorObj getJsonString]);
}
```

| パラメーター          | 型                  | 説明 |
| :------------------ | :------------------ | :------------------ |
| 戻り値               | [NSString: id] ※ JSONObject | エラー情報を JSONObject [NSString: id] 形式で返します。 |

### getJsonString メソッド
UnisizeSDK のエラー発生時に エラーに関する全ての情報を JSON String 形式で取得できます。  
各コンポーネントのデリゲートの didFail で取得可能。  

```objectiveC
// コンポーネントの処理失敗時に実行される
- (void)unisizeCVTag:(UnisizeCVTag *)cvTag didFail:(UnisizeError *)errorObj {
    // consoleに出力
    NSLog(@"%@", [errorObj getJsonString]);
}
```

| パラメーター          | 型                  | 説明 |
| :------------------ | :------------------ | :------------------ |
| 戻り値 | NSString | エラー情報を JSON String 形式で返します。 |



